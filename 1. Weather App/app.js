const api_key="a39a61df78a182057584f9699c3f7033";let input=document.getElementById("searchBar"),searchBtn=document.querySelector(".searchBtn"),cityName=document.getElementById("cityName"),weatherConditionIcon=document.getElementById("weatherConditionIcon"),temperature=document.getElementById("temperature"),humidity=document.getElementById("humidity"),windspeed=document.getElementById("windspeed"),locationDate=document.getElementById("l-d-date"),weatherdDesc=document.getElementById("description"),forecastDiv=document.querySelector(".forecastDiv");const weatherIcons={Clear:"images/weatherIcons/sun.png",Rain:"images/weatherIcons/rainy-day.png",Snow:"images/weatherIcons/snow.png",Mist:"images/weatherIcons/mist.png",Tornado:"images/weatherIcons/tornado.png",Thunderstorm:"images/weatherIcons/storm.png",Clouds:"images/weatherIcons/cloudy.png",Drizzle:"images/weatherIcons/drizzle.png",Smoke:"images/weatherIcons/smoke.png",Haze:"images/weatherIcons/haze.png",Dust:"images/weatherIcons/dust.png",Fog:"images/weatherIcons/fog.png",Ash:"images/weatherIcons/ash.png"};async function fetchWeather(e){try{let t=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&units=metric&appid=${api_key}`),n=await fetch("/countrycodes.json"),a=await n.json(),i=await t.json();if(200!=i.cod)document.getElementById("cityName").innerText="City not found!",document.getElementById("country").innerText="",console.clear();else{let r=i.dt;cityName.innerText=`${i.name},`,locationDate.innerText=`${formatDate(r)}`,document.getElementById("country").innerText=a[i.sys.country]||i.sys.country;let o=weatherIcons[i.weather[0].main];weatherConditionIcon.src=`${o}`,temperature.innerHTML=`${Math.round(i.main.temp)}&deg;C`,weatherdDesc.innerText=`${i.weather[0].description}`,humidity.innerText=`${i.main.humidity}%`,windspeed.innerText=`${Math.round(i.wind.speed)} m/s`,updateForecastInfo(e)}}catch(s){console.log("Error fetching details, try refreshing the page",s)}}async function updateForecastInfo(e){forecastDiv.innerHTML="";let t=(await (await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${e}&units=metric&appid=${api_key}`)).json()).list;t.forEach((e,n)=>{if(e.dt_txt.includes("00:00:00")){let a=weatherIcons[t[n].weather[0].main];forecastDiv.innerHTML+=`
		       <div class="forecast-container alignC directionColumn">
			       <p id="fore-date">${formatDate(e.dt).split(",")[1]}</p>
			       <img loading="lazy" src="${a}">
			       <p id="fore-temperature">${tempCheck(t[n].main.temp)}&deg;C</p>
		       </div>`}})}function tempCheck(e){return e<0?e:Math.round(e)}function formatDate(e){let t=new Date(1e3*e);return t.toLocaleDateString("en-GB",{weekday:"short",day:"2-digit",month:"short"})}input.addEventListener("keydown",e=>{let t=input.value;"Enter"==e.key&&(""==t?alert("Please enter a location first"):fetchWeather(t),input.value="")}),searchBtn.addEventListener("click",e=>{let t=input.value;""==t?alert("Please enter a location first"):fetchWeather(t),input.value=""});